"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(t,e):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var WebsyPopupDialog=function(){function n(t,e){if(_classCallCheck(this,n),this.options=_extends({},e),t){this.closeOnOutsideClick=!0;var i=document.getElementById(t);this.elementId=t,i.addEventListener("click",this.handleClick.bind(this))}else console.log("No element Id provided for Websy Popup")}return _createClass(n,[{key:"hide",value:function(){document.getElementById(this.elementId).innerHTML=""}},{key:"handleClick",value:function(t){if(t.target.classList.contains("websy-btn")){var e=t.target.getAttribute("data-index"),i=this.options.buttons[e];!0!==i.preventClose&&this.hide(),i.fn&&i.fn(i)}else!0===this.closeOnOutsideClick&&this.hide()}},{key:"render",value:function(){if(this.elementId){var t=document.getElementById(this.elementId),e="\n\t\t\t<div class='websy-popup-dialog-container'>\n\t\t\t\t<div class='websy-popup-dialog'>\n\t\t";if(this.options.title&&(e+="<h1>".concat(this.options.title,"</h1>")),this.options.message&&(e+="<p>".concat(this.options.message,"</p>")),this.closeOnOutsideClick=!0,this.options.buttons){!0!==this.options.allowCloseOnOutsideClick&&(this.closeOnOutsideClick=!1),e+="<div class='websy-popup-button-panel'>";for(var i=0;i<this.options.buttons.length;i++)e+="\n\t\t\t\t\t<button class='websy-btn ".concat((this.options.buttons[i].classes||[]).join(" "),"' data-index='").concat(i,"'>\n\t\t\t\t\t\t").concat(this.options.buttons[i].label,"\n\t\t\t\t\t</button>\n\t\t\t\t");e+="</div>"}e+="\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t",t.innerHTML=e}else console.log("No element Id provided for Websy Popup")}},{key:"show",value:function(t){t&&(this.options=_extends({},t)),this.render()}}]),n}(),WebsyLoadingDialog=function(){function i(t,e){_classCallCheck(this,i),this.options=_extends({},e),t?this.elementId=t:console.log("No element Id provided")}return _createClass(i,[{key:"hide",value:function(){var t=document.getElementById(this.elementId);t.classList.remove("loading"),t.innerHTML=""}},{key:"render",value:function(){if(this.elementId){var t=document.getElementById(this.elementId),e="\n\t\t\t<div class='websy-loading-container ".concat((this.options.classes||[]).join(" "),"'>\n\t\t\t\t<div class='websy-ripple'>\n\t\t\t\t\t<div></div>\n\t\t\t\t\t<div></div>\n\t\t\t\t</div>\n\t\t\t\t<h4>").concat(this.options.title||"Loading...","</h4>\n\t\t");if(this.options.messages)for(var i=0;i<this.options.messages.length;i++)e+="<p>".concat(this.options.messages[i],"</p>");e+="\n\t\t\t</div>\t\n    ",t.classList.add("loading"),t.innerHTML=e}else console.log("No element Id provided for Websy Loading Dialog")}},{key:"show",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1];t&&(this.options=!0===e?_extends({},t):_extends({},this.options,t)),this.render()}}]),i}(),WebsyNavigationMenu=function(){function n(t,e){if(_classCallCheck(this,n),this.options=_extends({},{orientation:"horizontal"},e),t){var i=document.getElementById(t);i&&(this.elementId=t,i.classList.add("websy-".concat(this.options.orientation,"-list-container")),this.options.classes&&this.options.classes.forEach(function(t){return i.classList.add(t)}),i.addEventListener("click",this.handleClick.bind(this)),this.render())}else console.log("No element Id provided for Websy Menu")}return _createClass(n,[{key:"handleClick",value:function(t){(t.target.classList.contains("websy-menu-icon")||"svg"===t.target.nodeName||"rect"===t.target.nodeName)&&this.toggleMobileMenu(),t.target.classList.contains("trigger-item")&&t.target.classList.contains("websy-menu-header")&&this.toggleMobileMenu("remove"),t.target.classList.contains("websy-menu-mask")&&this.toggleMobileMenu()}},{key:"normaliseString",value:function(t){return t.replace(/-/g,"").replace(/\s/g,"_")}},{key:"render",value:function(){var t=document.getElementById(this.elementId);if(t){var e="";this.options.logo&&(e+="\n          <div id='".concat(this.elementId,'_menuIcon\' class=\'websy-menu-icon\'>\n            <svg viewbox="0 0 40 40" width="40" height="40">              \n              <rect x="0" y="0" width="40" height="4" rx="2"></rect>\n              <rect x="0" y="12" width="40" height="4" rx="2"></rect>\n              <rect x="0" y="24" width="40" height="4" rx="2"></rect>\n            </svg>\n            </div>\n          <div \n            class=\'logo ').concat(this.options.logo.classes&&this.options.logo.classes.join(" ")||"","'\n            ").concat(this.options.logo.attributes&&this.options.logo.attributes.join(" "),"\n          >\n          <img src='").concat(this.options.logo.url,"'></img>\n          </div>\n          <div id='").concat(this.elementId,"_mask' class='websy-menu-mask'></div>\n          <div id=\"").concat(this.elementId,'_menuContainer" class="websy-menu-block-container">\n        ')),e+=this.renderBlock(this.options.items,"main",1),e+="</div>",t.innerHTML=e,this.options.navigator&&this.options.navigator.registerElements(t)}}},{key:"renderBlock",value:function(t,e,i){var n="\n\t\t  <ul class='websy-".concat(this.options.orientation,"-list ").concat("main"!==e?"websy-menu-collapsed":"","' id='").concat(this.elementId,"_").concat(e,"_list'\n\t  ");"main"!==e&&(n+=" data-collapsed='".concat("main"!==e?"true":"false","'")),n+=">";for(var s=0;s<t.length;s++){var o=!0===t[s].default?"active":"",a=this.normaliseString(t[s].text);n+="\n\t\t\t<li class='websy-".concat(this.options.orientation,"-list-item'>\n\t\t\t\t<div class='websy-menu-header ").concat(t[s].classes&&t[s].classes.join(" ")," ").concat(""," ").concat(o,"' \n\t\t\t\t\t\t id='").concat(this.elementId,"_").concat(a,"_label' \n\t\t\t\t\t\t data-id='").concat(a,"' \n\t\t\t\t\t\t data-popout-id='").concat(1<i?e:a,"'\n\t\t\t\t\t\t data-text='").concat(t[s].text,"'\n\t\t\t\t\t\t style='padding-left: ").concat(i*this.options.menuHPadding,"px'\n\t\t\t\t\t\t ").concat(t[s].attributes&&t[s].attributes.join(" "),"\n        >\n      "),"horizontal"===this.options.orientation&&(n+=t[s].text),n+="\n          <span class='selected-bar'></span>\n          <span class='active-square'></span>\n          <span class='".concat(t[s].items&&0<t[s].items.length?"menu-carat":"","'></span>\n      "),"vertical"===this.options.orientation&&(n+="\n          &nbsp;\n        "),n+="    \n\t\t\t\t</div>\n\t\t  ",t[s].items&&(n+=this.renderBlock(t[s].items,a,i+1)),e&&"main"!==e&&(this.options.parentMap[a]||(this.options.parentMap[a]=e)),n+="\n\t\t\t</li>\n\t\t"}return n+="</ul>"}},{key:"toggleMobileMenu",value:function(t){void 0===t&&(t="toggle");var e=document.getElementById("".concat(this.elementId));e&&e.classList[t]("open"),this.options.onToggle&&this.options.onToggle(t)}}]),n}(),WebsyForm=function(){function s(t,e){_classCallCheck(this,s);var i={submit:{text:"Save",classes:""},clearAfterSave:!1,fields:[],onSuccess:function(t){},onError:function(t){console.log("Error submitting form data:",t)}};if(GlobalPubSub.subscribe("recaptchaready",this.recaptchaReady.bind(this)),this.recaptchaResult=null,this.options=_extends(i,{},{},e),t){this.apiService=new WebsyDesigns.APIService(""),this.elementId=t;var n=document.getElementById(t);n&&(this.options.classes&&this.options.classes.forEach(function(t){return n.classList.add(t)}),n.addEventListener("click",this.handleClick.bind(this)),n.addEventListener("keyup",this.handleKeyUp.bind(this)),n.addEventListener("keydown",this.handleKeyDown.bind(this)),this.render())}else console.log("No element Id provided")}return _createClass(s,[{key:"checkRecaptcha",value:function(){var t=this;return new Promise(function(e,i){!0===t.options.useRecaptcha?t.recaptchaValue?t.apiService.add("/google/checkrecaptcha",JSON.stringify({grecaptcharesponse:t.recaptchaValue})).then(function(t){t.success&&!0===t.success?e(!0):i(!1)}):i(!1):e(!0)})}},{key:"handleClick",value:function(t){t.target.classList.contains("submit")&&this.submitForm()}},{key:"handleKeyDown",value:function(t){"enter"===t.key&&this.submitForm()}},{key:"handleKeyUp",value:function(t){}},{key:"recaptchaReady",value:function(){document.getElementById("".concat(this.elementId,"_recaptcha"))&&grecaptcha.render("".concat(this.elementId,"_recaptcha"),{sitekey:ENVIRONMENT.RECAPTCHA_KEY,callback:this.validateRecaptcha.bind(this)})}},{key:"render",value:function(t,e){var i=this,n=document.getElementById(this.elementId);if(n){var s='\n        <form id="'.concat(this.elementId,'Form">\n      ');this.options.fields.forEach(function(t){"longtext"===t.type?s+="\n            ".concat(t.label?'<label for="'.concat(t.field,'">').concat(t.label,"</label>"):"",'\n            <textarea\n              id="').concat(i.elementId,"_input_").concat(t.field,'"\n              ').concat(!0===t.required?"required":"",' \n              placeholder="').concat(t.placeholder||"",'"\n              name="').concat(t.field,'" \n              class="websy-input websy-textarea ').concat(t.classes,'"\n            ></textarea>\n          '):s+="\n            ".concat(t.label?'<label for="'.concat(t.field,'">').concat(t.label,"</label>"):"",'\n            <input \n              id="').concat(i.elementId,"_input_").concat(t.field,'"\n              ').concat(!0===t.required?"required":"",' \n              type="').concat(t.type||"text",'" \n              class="websy-input ').concat(t.classes,'" \n              name="').concat(t.field,'" \n              placeholder="').concat(t.placeholder||"",'"\n              value="').concat(t.value||"",'"\n              oninvalidx="this.setCustomValidity(\'').concat(t.invalidMessage||"Please fill in this field.","')\"\n            />\n          ")}),s+="          \n        </form>\n      ",!0===this.options.useRecaptcha&&(s+="\n          <div id='".concat(this.elementId,"_recaptcha'></div>\n        ")),s+='\n        <button class="websy-btn submit '.concat(this.options.submit.classes,'">').concat(this.options.submit.text||"Save","</button>\n      "),n.innerHTML=s,!0===this.options.useRecaptcha&&"undefined"!=typeof grecaptcha&&this.recaptchaReady()}}},{key:"submitForm",value:function(){var e=this,n=document.getElementById("".concat(this.elementId,"Form"));!0===n.reportValidity()&&this.checkRecaptcha().then(function(t){if(!0===t){new FormData(n);var i={};new FormData(n).forEach(function(t,e){i[e]=t}),e.options.url?e.apiService.add(e.options.url,i).then(function(t){!0===e.options.clearAfterSave&&n.reset(),e.options.onSuccess.call(e,t)},function(t){console.log("Error submitting form data:",t),e.options.onError.call(e,t)}):e.options.submitFn&&(e.options.submitFn(i),!0===e.options.clearAfterSave&&n.reset())}else console.log("bad recaptcha")})}},{key:"validateRecaptcha",value:function(t){this.recaptchaValue=t}},{key:"data",set:function(i){var n=this;this.options.fields||(this.options.fields=[]);var t=function(e){n.options.fields.forEach(function(t){t.field===e&&(t.value=i[e],document.getElementById("".concat(n.elementId,"_input_").concat(t.field)).value=t.value)})};for(var e in i)t(e);this.render()}}]),s}(),WebsyDatePicker=function(){function s(t,e){_classCallCheck(this,s);var i={defaultRange:2,ranges:[{label:"Today",range:[new Date]},{label:"Yesterday",range:[new Date]},{label:"Last 7 Days",range:[new Date]},{label:"This Month",range:[new Date]},{label:"This Year",range:[new Date]}]};if(this.options=_extends({},i,e),this.selectedRange=this.options.defaultRange||0,t){var n=document.getElementById(t);n?(this.elementId=t,n.addEventListener("click",this.handleClick.bind(this)),this.render()):console.log("No element found with Id",t)}else console.log("No element Id provided")}return _createClass(s,[{key:"close",value:function(){var t=document.getElementById("".concat(this.elementId,"_mask")),e=document.getElementById("".concat(this.elementId,"_content"));t.classList.remove("active"),e.classList.remove("active")}},{key:"handleClick",value:function(t){if(t.target.classList.contains("websy-date-picker-header"))this.open();else if(t.target.classList.contains("websy-date-picker-mask"))this.close();else if(t.target.classList.contains("websy-date-picker-range")){var e=t.target.getAttribute("data-index");this.updateRange(e)}}},{key:"open",value:function(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1];var e=document.getElementById("".concat(this.elementId,"_mask")),i=document.getElementById("".concat(this.elementId,"_content"));e.classList.add("active"),i.classList.add("active")}},{key:"render",value:function(){var i=this;if(this.elementId){var t=document.getElementById(this.elementId),e="\n\t\t\t<div class='websy-date-picker-container'>\n        <div class='websy-date-picker-header'>\n          <span id='".concat(this.elementId,"_selectedRange'>").concat(this.options.ranges[this.selectedRange].label,'</span>\n          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.677 18.52c.914 1.523-.183 3.472-1.967 3.472h-19.414c-1.784 0-2.881-1.949-1.967-3.472l9.709-16.18c.891-1.483 3.041-1.48 3.93 0l9.709 16.18z"/></svg>\n        </div>\n        <div id=\'').concat(this.elementId,"_mask' class='websy-date-picker-mask'></div>\n        <div id='").concat(this.elementId,"_content' class='websy-date-picker-content'>\n          <div class='websy-date-picker-ranges'>\n            <ul>\n              ").concat(this.options.ranges.map(function(t,e){return"\n                <li data-index='".concat(e,"' class='websy-date-picker-range ").concat(e===i.selectedRange?"active":"","'>").concat(t.label,"</li>\n              ")}).join(""),"\n            </ul>\n          </div>\x3c!--\n          --\x3e<div class='websy-date-picker-custom'></div>\n        </div>\n      </div>\n    ");t.innerHTML=e}else console.log("No element Id provided for Websy Loading Dialog")}},{key:"updateRange",value:function(t){if(t!==this.selectedRange){this.selectedRange=t;for(var e=this.options.ranges[t],i=document.getElementById(this.elementId),n=document.getElementById("".concat(this.elementId,"_selectedRange")),s=i.querySelectorAll(".websy-date-picker-range"),o=0;o<s.length;o++)s[o].classList.remove("active"),o===t&&s[o].classList.add("active");n&&(n.innerHTML=e.label,this.options.onRangeChanged&&this.options.onRangeChanged(e),this.close())}}}]),s}(),WebsyDropdown=function(){function n(t,e){_classCallCheck(this,n);if(this.options=_extends({},{multiSelect:!1,allowClear:!0,style:"plain",items:[],label:""},e),this.selectedItems=[],t){var i=document.getElementById(t);i?(this.elementId=t,i.addEventListener("click",this.handleClick.bind(this)),this.render()):console.log("No element found with Id",t)}else console.log("No element Id provided")}return _createClass(n,[{key:"close",value:function(){var t=document.getElementById("".concat(this.elementId,"_mask")),e=document.getElementById("".concat(this.elementId,"_content"));t.classList.remove("active"),e.classList.remove("active")}},{key:"handleClick",value:function(t){if(t.target.classList.contains("websy-dropdown-header"))this.open();else if(t.target.classList.contains("websy-dropdown-mask"))this.close();else if(t.target.classList.contains("websy-dropdown-item")){var e=t.target.getAttribute("data-index");this.updateSelected(+e)}}},{key:"open",value:function(t){1<arguments.length&&void 0!==arguments[1]&&arguments[1];var e=document.getElementById("".concat(this.elementId,"_mask")),i=document.getElementById("".concat(this.elementId,"_content"));e.classList.add("active"),i.classList.add("active")}},{key:"render",value:function(){var i=this;if(this.elementId){var t=document.getElementById(this.elementId);console.log("rendering dropdown",this.selectedItems),console.log(1===this.selectedItems.length?"one-selected":"");var e="\n      <div class='websy-dropdown-container'>\n        <div id='".concat(this.elementId,"_header' class='websy-dropdown-header ").concat(1===this.selectedItems.length?"one-selected":"","'>\n          <span class='websy-dropdown-header-label'>").concat(this.options.label,"</span>\n          <span class='websy-dropdown-header-value' id='").concat(this.elementId,"_selectedItems'>").concat(this.selectedItems.map(function(t){return i.options.items[t].label}).join(","),'</span>\n          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M23.677 18.52c.914 1.523-.183 3.472-1.967 3.472h-19.414c-1.784 0-2.881-1.949-1.967-3.472l9.709-16.18c.891-1.483 3.041-1.48 3.93 0l9.709 16.18z"/></svg>\n        </div>\n        <div id=\'').concat(this.elementId,"_mask' class='websy-dropdown-mask'></div>\n        <div id='").concat(this.elementId,"_content' class='websy-dropdown-content'>\n          <div class='websy-dropdown-items'>\n            <ul>\n              ").concat(this.options.items.map(function(t,e){return"\n                <li data-index='".concat(e,"' class='websy-dropdown-item ").concat(-1!==i.selectedItems.indexOf(e)?"active":"","'>").concat(t.label,"</li>\n              ")}).join(""),"\n            </ul>\n          </div>\x3c!--\n          --\x3e<div class='websy-dropdown-custom'></div>\n        </div>\n      </div>\n    ");t.innerHTML=e}else console.log("No element Id provided for Websy Loading Dialog")}},{key:"updateSelected",value:function(t){if(null!=t){if(-1!==this.selectedItems.indexOf(t))return;!1===this.options.multiSelect?this.selectedItems=[t]:this.selectedItems.push(t)}for(var e=this.options.items[t],i=document.getElementById(this.elementId),n=document.getElementById("".concat(this.elementId,"_header")),s=document.getElementById("".concat(this.elementId,"_selectedItems")),o=i.querySelectorAll(".websy-dropdown-item"),a=0;a<o.length;a++)o[a].classList.remove("active"),-1!==this.selectedItems.indexOf(a)&&o[a].classList.add("active");n&&(n.classList.remove("one-selected"),n.classList.remove("multi-selected"),1===this.selectedItems.length?n.classList.add("one-selected"):1<this.selectedItems.length&&n.classList.add("multi-selected")),s&&(1===this.selectedItems.length?s.innerHTML=e.label:1<this.selectedItems.length?s.innerHTML="".concat(this.selectedItems.length," selected"):(console.log("we got here for some reason"),s.innerHTML=""),this.options.onItemSelected&&this.options.onItemSelected(e,this.selectedItems,this.options.items),this.close())}},{key:"selections",set:function(t){this.selectedItems=t||[]}},{key:"data",set:function(t){this.options.items=t||[],this.render()},get:function(){return this.options.items}}]),n}(),WebsyResultList=function(){function s(t,e){var i=this;_classCallCheck(this,s);if(this.options=_extends({},{listeners:{click:{}}},e),this.elementId=t,this.rows=[],this.apiService=new WebsyDesigns.APIService("/api"),this.templateService=new WebsyDesigns.APIService(""),t){var n=document.getElementById(t);n&&n.addEventListener("click",this.handleClick.bind(this)),"object"===_typeof(e.template)&&e.template.url?this.templateService.get(e.template.url).then(function(t){i.options.template=t,i.render()}):this.render()}else console.log("No element Id provided for Websy Search List")}return _createClass(s,[{key:"appendData",value:function(t){var e=this.rows.length;this.rows=this.rows.concat(t);var i=this.buildHTML(t,e);document.getElementById(this.elementId).innerHTML+=i.replace(/\n/g,"")}},{key:"buildHTML",value:function(s){var o=this,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c="";return this.options.template&&(0<s.length?s.forEach(function(r,e){var l="".concat(0<e?"--\x3e":"").concat(o.options.template).concat(e<s.length-1?"\x3c!--":"");_toConsumableArray(l.matchAll(/<\s*if[^>]*>([\s\S]*?)<\s*\/\s*if>/g)).forEach(function(t){if(t[0]&&-1<t.index){var e=t[0].match(/(\scondition=["|']\w.+)["|']/g);if(e&&e[0]){var i=e[0].trim().replace("condition=","");'"'===i.split("")[0]?i=i.replace(/"/g,""):"'"===i.split("")[0]&&(i=i.replace(/'/g,""));var n=[],s=!0;-1!==i.indexOf("===")?n=i.split("==="):-1!==i.indexOf("!==")?(n=i.split("!=="),s=!1):-1!==i.indexOf("==")?n=i.split("=="):-1!==i.indexOf("!=")&&(n=i.split("!="),s=!1);var o=!0;if(2===n.length&&(isNaN(n[1])||(n[1]=+n[1]),"true"===n[1]&&(n[1]=!0),"false"===n[1]&&(n[1]=!1),"string"==typeof n[1]&&(-1!==n[1].indexOf('"')?n[1]=n[1].replace(/"/g,""):-1!==n[1].indexOf("'")&&(n[1]=n[1].replace(/'/g,""))),!0===s?void 0!==r[n[0]]&&r[n[0]]===n[1]?o=!1:n[0]===n[1]&&(o=!1):!1===s&&void 0!==r[n[0]]&&r[n[0]]!==n[1]&&(o=!1)),!0===o)l=l.replace(t[0],"");else{var a=t[0];a=a.replace("</if>","").replace(/<\s*if[^>]*>/g,""),l=l.replace(t[0],a)}}}});var t=_toConsumableArray(l.matchAll(/(\sdata-event=["|']\w.+)["|']/g));for(var i in t.forEach(function(t){t[0]&&-1<t.index&&(l=l.replace(t[0],"".concat(t[0]," data-id=").concat(a+e)))}),r){var n=new RegExp("{".concat(i,"}"),"gm");l=l.replace(n,r[i])}c+=l}):this.options.noRowsHTML&&(c+=this.options.noRowsHTML)),c}},{key:"findById",value:function(t){for(var e=0;e<this.rows.length;e++)if(this.rows[e].id===t)return this.rows[e];return null}},{key:"handleClick",value:function(t){var e=this;if(t.target.classList.contains("clickable")){var i=t.target.getAttribute("data-event");if(i){i=i.split("(");var n,s=[],o=t.target.getAttribute("data-id");if(i[1]&&(i[1]=i[1].replace(")",""),s=i[1].split(",")),i=i[0],s=s.map(function(t){return"string"!=typeof t&&"number"!=typeof t?e.rows[+o]&&(t=e.rows[+o][t]):"string"==typeof t&&(t=t.replace(/"/g,"").replace(/'/g,"")),t}),t.target.classList.contains("clickable")&&this.options.listeners.click[i])t.stopPropagation(),(n=this.options.listeners.click[i]).call.apply(n,[this,t,this.rows[+o]].concat(_toConsumableArray(s)))}}}},{key:"render",value:function(){var e=this;this.options.entity?this.apiService.get(this.options.entity).then(function(t){e.rows=t.rows,e.resize()}):this.resize()}},{key:"resize",value:function(){var t=this.buildHTML(this.rows);document.getElementById(this.elementId).innerHTML=t.replace(/\n/g,"")}},{key:"data",set:function(t){this.rows=t||[],this.render()},get:function(){return this.rows}}]),s}(),WebsyPubSub=function(){function i(t,e){_classCallCheck(this,i),this.options=_extends({},e),t?(this.elementId=t,this.subscriptions={}):console.log("No element Id provided")}return _createClass(i,[{key:"publish",value:function(t,e){this.subscriptions[t]&&this.subscriptions[t].forEach(function(t){t(e)})}},{key:"subscribe",value:function(t,e){this.subscriptions[t]||(this.subscriptions[t]=[]),this.subscriptions[t].push(e)}}]),i}(),APIService=function(){function e(t){_classCallCheck(this,e),this.baseUrl=t}return _createClass(e,[{key:"add",value:function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=this.buildUrl(t);return this.run("POST",n,e,i)}},{key:"buildUrl",value:function(t,e,i){return void 0===i&&(i=[]),e&&i.push("id:".concat(e)),"".concat(this.baseUrl,"/").concat(t).concat(0<i.length?"?where=".concat(i.join(";")):"")}},{key:"delete",value:function(t,e){var i=this.buildUrl(t,e);return this.run("DELETE",i)}},{key:"get",value:function(t,e,i){var n=this.buildUrl(t,e,i);return this.run("GET",n)}},{key:"update",value:function(t,e,i){var n=this.buildUrl(t,e);return this.run("PUT",n,i)}},{key:"fetchData",value:function(t,e,i){3<arguments.length&&void 0!==arguments[3]&&arguments[3];return fetch(e,{method:t,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(i)}).then(function(t){return t.json()})}},{key:"run",value:function(s,o,a){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},l=4<arguments.length&&void 0!==arguments[4]&&arguments[4];return new Promise(function(e,i){var n=new XMLHttpRequest;if(n.open(s,o),n.setRequestHeader("Content-Type","application/json"),n.responseType="text",r.responseType&&(n.responseType=r.responseType),r.headers)for(var t in r.headers)n.setRequestHeader(t,r.headers[t]);n.withCredentials=!0,console.log("using this"),n.onload=function(){if(401!==n.status){var t="text"===n.responseType?n.responseText:n.response;if(""!==t&&"null"!==t)try{t=JSON.parse(t)}catch(t){}else t=[];t.err?i(JSON.stringify(t)):e(!0===l?[t,function(t){t=t.split("\r\n");var e={};return t.forEach(function(t){2===(t=t.split(":")).length&&(e[t[0]]=t[1].trim())}),e}(n.getAllResponseHeaders())]:t)}else ENV&&ENV.AUTH_REDIRECT?window.location=ENV.AUTH_REDIRECT:window.location="/login"},n.onerror=function(){return i(n.statusText)},a?n.send(JSON.stringify(a)):n.send()})}}]),e}(),WebsyPDFButton=function(){function n(t,e){_classCallCheck(this,n);this.elementId=t,this.options=_extends({},{classes:[]},e),this.service=new WebsyDesigns.APIService("pdf");var i=document.getElementById(this.elementId);i&&(i.addEventListener("click",this.handleClick.bind(this)),e.html?i.innerHTML=e.html:i.innerHTML="\n          <button class='websy-btn websy-pdf-button ".concat(this.options.classes.join(" "),'\'>\n            Create PDF\n            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                viewBox="0 0 184.153 184.153" style="enable-background:new 0 0 184.153 184.153;" xml:space="preserve">\n              <g>\n                <g>\n                  <g>\n                    <path d="M129.318,0H26.06c-1.919,0-3.475,1.554-3.475,3.475v177.203c0,1.92,1.556,3.475,3.475,3.475h132.034\n                      c1.919,0,3.475-1.554,3.475-3.475V34.131C161.568,22.011,140.771,0,129.318,0z M154.62,177.203H29.535V6.949h99.784\n                      c7.803,0,25.301,18.798,25.301,27.182V177.203z"/>\n                    <path d="M71.23,76.441c15.327,0,27.797-12.47,27.797-27.797c0-15.327-12.47-27.797-27.797-27.797\n                      c-15.327,0-27.797,12.47-27.797,27.797C43.433,63.971,55.902,76.441,71.23,76.441z M71.229,27.797\n                      c11.497,0,20.848,9.351,20.848,20.847c0,0.888-0.074,1.758-0.183,2.617l-18.071-2.708L62.505,29.735\n                      C65.162,28.503,68.112,27.797,71.229,27.797z M56.761,33.668l11.951,19.869c0.534,0.889,1.437,1.49,2.462,1.646l18.669,2.799\n                      c-3.433,6.814-10.477,11.51-18.613,11.51c-11.496,0-20.847-9.351-20.847-20.847C50.381,42.767,52.836,37.461,56.761,33.668z"/>\n                    <rect x="46.907" y="90.339" width="73.058" height="6.949"/>\n                    <rect x="46.907" y="107.712" width="48.644" height="6.949"/>\n                    <rect x="46.907" y="125.085" width="62.542" height="6.949"/>\n                  </g>\n                </g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              <g>\n              </g>\n              </svg>\n          </button>\n        '))}return _createClass(n,[{key:"handleClick",value:function(t){if(t.target.classList.contains("websy-pdf-button")&&this.options.targetId){var e=document.getElementById(this.options.targetId);if(e){var i={options:{}};this.options.pdfOptions&&(i.options=_extends({},this.options.pdfOptions)),this.options.header&&(i.header=this.options.header),this.options.footer&&(i.footer=this.options.footer),i.html=e.outerHTML,this.service.add("",i).then(function(t){console.log(t)},function(t){console.error(t)})}}}},{key:"render",value:function(){}}]),n}(),WebsyTable=function(){function n(t,e){_classCallCheck(this,n);this.elementId=t,this.options=_extends({},{pageSize:20},e),this.rowCount=0,this.busy=!1;var i=document.getElementById(this.elementId);i?(i.innerHTML='\n        <div class=\'websy-vis-table\'>\n          \x3c!--<div class="download-button">\n            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M16 11h5l-9 10-9-10h5v-11h8v11zm1 11h-10v2h10v-2z"/></svg>\n          </div>--\x3e\n          <table>\n            \x3c!--<thead id="'.concat(this.elementId,'_head">\n            </thead>--\x3e\n            <tbody id="').concat(this.elementId,'_body">\n            </tbody>\n          </table>\n        </div>\n      '),i.addEventListener("click",this.handleClick.bind(this)),document.getElementById("".concat(this.elementId)).addEventListener("scroll",this.handleScroll.bind(this)),this.init()):console.error("No element found with ID ".concat(this.elementId))}return _createClass(n,[{key:"appendRows",value:function(t){var n=this,e="";t&&(e+=t.qMatrix.map(function(t){return"<tr>"+t.map(function(t,e){if(!1!==n.columns[e].show){if(!0===n.columns[e].showAsLink&&""!==t.qText.trim())return"\n                <td data-view='".concat(t.qText,"' data-index='").concat(e,"' class='trigger-item ").concat(!0===n.columns[e].selectOnClick?"selectable":""," ").concat(n.columns[e].classes||"","' ").concat(n.columns[e].width?'style="width: '+n.columns[e].width+'"':"",">").concat(n.columns[e].linkText||"Link","</td>\n              ");var i="NaN"===t.qNum?t.qText:t.qNum.toReduced(2,-1!==t.qText.indexOf("%"));return t.qText&&-1!==t.qText.indexOf("€")&&(i=i.toCurrency("€")),"\n                <td class='".concat(n.columns[e].classes||"","' ").concat(n.columns[e].width?'style="width: '+n.columns[e].width+'"':"",">").concat(i,"</td>\n              ")}}).join("")+"</tr>"}).join("")),document.getElementById("".concat(this.elementId,"_body")).innerHTML+=e}},{key:"buildSearchIcon",value:function(t){return'\n      <div>\n        <svg\n          class="tableSearchIcon"\n          data-field="'.concat(t,'"\n          xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"\n        >\n          <path d="M0 0h24v24H0z" fill="none"/>\n          <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>\n        </svg>\n      </div>\n    ')}},{key:"getData",value:function(e){var i=this;if(!1===this.busy){this.busy=!0;var t=[{qTop:this.rowCount,qLeft:0,qWidth:this.dataWidth,qHeight:1e4<this.dataWidth*this.options.pageSize?Math.floor(1e4/this.dataWidth):this.options.pageSize}];this.rowCount<this.layout.qHyperCube.qSize.qcy?this.options.model.getHyperCubeData("/qHyperCubeDef",t).then(function(t){t&&t[0]&&(t[0].qMatrix=t[0].qMatrix.filter(function(t){return"-"!==t[0].qText}),i.layout.qHyperCube.qDataPages.push(t[0]),i.rowCount+=t[0].qMatrix.length,i.busy=!1,e&&e(t[0]))}):this.busy=!1}}},{key:"handleClick",value:function(t){if(t.target.classList.contains("download-button")&&window.viewManager.dataExportController.exportData(this.options.model),t.target.classList.contains("sortable-column")){var e=+t.target.getAttribute("data-index"),i=+t.target.getAttribute("data-dim-index"),n=+t.target.getAttribute("data-exp-index"),s="true"===t.target.getAttribute("data-reverse"),o=[{qOp:"replace",qPath:"/qHyperCubeDef/qInterColumnSortOrder",qValue:JSON.stringify([e])}];o.push({qOp:"replace",qPath:"/qHyperCubeDef/".concat(-1<i?"qDimensions":"qMeasures","/").concat(-1<i?i:n,"/qDef/qReverseSort"),qValue:JSON.stringify(s)}),this.options.model.applyPatches(o)}else if(t.target.classList.contains("tableSearchIcon")){var a=t.target.getAttribute("data-field");window.viewManager.views.global.objects[1].instance.show(a,{x:t.pageX,y:t.pageY},function(){t.target.classList.remove("active")})}else if(t.target.classList.contains("selectable")){var r=t.target.getAttribute("data-index"),l=this.layout.qHyperCube.qDataPages[0].qMatrix[r];this.options.model.selectHyperCubeValues("/qHyperCubeDef",0,[l[0].qElemNumber],!1)}}},{key:"handleScroll",value:function(t){var e=this;.7<t.target.scrollTop/(t.target.scrollHeight-t.target.clientHeight)&&this.getData(function(t){e.appendRows(t)})}},{key:"init",value:function(){this.render()}},{key:"render",value:function(){var i=this;document.getElementById("".concat(this.elementId,"_body")).innerHTML="",this.rowCount=0,this.options.model.getLayout().then(function(t){i.layout=t,i.dataWidth=i.layout.qHyperCube.qSize.qcx,i.columnOrder=i.layout.qHyperCube.qColumnOrder,void 0===i.columnOrder&&(i.columnOrder=new Array(i.layout.qHyperCube.qSize.qcx).fill({}).map(function(t,e){return e})),i.columns=i.layout.qHyperCube.qDimensionInfo.concat(i.layout.qHyperCube.qMeasureInfo),i.columns=i.columns.map(function(t,e){return t.colIndex=i.columnOrder.indexOf(e),t}),i.columns.sort(function(t,e){return t.colIndex-e.colIndex}),i.activeSort=i.layout.qHyperCube.qEffectiveInterColumnSortOrder[0],i.getData(function(t){i.update()})})}},{key:"update",value:function(){var i=this;if(!0===this.layout.allowDownload){var t=document.getElementById(this.elementId);t?t.classList.add("allow-download"):t.classList.remove("allow-download")}var e="<tr>"+this.columns.map(function(t,e){if(!1!==t.show)return"\n        <th ".concat(t.width?'style="width: '+t.width+'"':"",'>\n          <div class ="tableHeader">\n            <div class="leftSection">\n              <div\n                class="tableHeaderField ').concat(-1!==["A","D"].indexOf(t.qSortIndicator)?"sortable-column":"",'"\n                data-index="').concat(e,'"\n                data-dim-index="').concat(e<i.layout.qHyperCube.qDimensionInfo.length?e:-1,'"\n                data-exp-index="').concat(e>=i.layout.qHyperCube.qDimensionInfo.length?e-i.layout.qHyperCube.qDimensionInfo.length:-1,'"\n                data-sort="').concat(t.qSortIndicator,'"\n                data-reverse="').concat(i.activeSort===e&&!0!==t.qReverseSort,'"\n              >\n                ').concat(t.qFallbackTitle,'\n              </div>\n            </div>\n            <div class="').concat(i.activeSort===e?"sortOrder":""," ").concat("A"===t.qSortIndicator?"ascending":"descending",'"></div>\n            ').concat(!0===t.searchable?i.buildSearchIcon(t.qGroupFieldDefs[0]):"","\n          </div>\n        </th>\n        ")}).join("")+"</tr>";document.getElementById("".concat(this.elementId,"_body")).innerHTML=e,this.appendRows(this.layout.qHyperCube.qDataPages[0])}}]),n}(),WebsyChart=function(){function s(t,e){_classCallCheck(this,s);var i={margin:{top:3,left:3,bottom:3,right:3,axisBottom:0,axisLeft:0,axisRight:0},orientation:"vertical",colors:d3.schemeCategory10,transitionDuration:650,curveStyle:"curveLinear",lineWidth:2,forceZero:!0,fontSize:14,symbolSize:20};if(this.elementId=t,this.options=_extends({},i,e),this.leftAxis=null,this.rightAxis=null,this.topAxis=null,this.bottomAxis=null,t){var n=document.getElementById(this.elementId);n?(n.classList.add("websy-chart"),"undefined"==typeof d3?console.error("d3 library has not been loaded"):(this.svg=d3.select(n).append("svg"),this.prep())):console.error("No element found with ID ".concat(this.elementId))}else console.log("No element Id provided for Websy Menu")}return _createClass(s,[{key:"createIdentity",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10,e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<t;n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e}},{key:"prep",value:function(){this.leftAxisLayer=this.svg.append("g"),this.rightAxisLayer=this.svg.append("g"),this.bottomAxisLayer=this.svg.append("g"),this.plotArea=this.svg.append("g"),this.areaLayer=this.svg.append("g"),this.lineLayer=this.svg.append("g"),this.barLayer=this.svg.append("g"),this.symbolLayer=this.svg.append("g"),this.trackingLineLayer=this.svg.append("g"),this.render()}},{key:"render",value:function(t){var i=this;if(void 0!==t&&(this.options=_extends({},this.options,t)),this.options.data){this.transition=d3.transition().duration(this.options.transitionDuration),!0===this.options.disableTransitions&&(this.transition=d3.transition().duration(0)),this.options.data.left||(this.options.data.left={data:[]}),this.options.data.right||(this.options.data.right={data:[]}),this.options.data.bottom||(this.options.data.bottom={data:[]}),"vertical"===this.options.orientation?(this.leftAxisLayer.attr("class","y-axis"),this.rightAxisLayer.attr("class","y-axis"),this.bottomAxisLayer.attr("class","x-axis")):(this.leftAxisLayer.attr("class","x-axis"),this.rightAxisLayer.attr("class","x-axis"),this.bottomAxisLayer.attr("class","y-axis"));var e=document.getElementById(this.elementId);if(e){this.width=e.clientWidth,this.height=e.clientHeight,this.svg.attr("width",this.width).attr("height",this.height),this.longestLeft=0,this.longestRight=0,this.longestBottom=0,this.options.data.bottom&&this.options.data.bottom.data&&void 0===this.options.data.bottom.max&&(this.options.data.bottom.max=this.options.data.bottom.data.reduce(function(t,e){return t.length>e.value.length?t:e.value},""),this.options.data.bottom.min=this.options.data.bottom.data.reduce(function(t,e){return t.length<e.value.length?t:e.value},this.options.data.bottom.max)),this.options.data.bottom&&void 0!==this.options.data.bottom.max&&(this.longestBottom=this.options.data.bottom.max.toString().length,this.options.data.bottom.formatter&&(this.longestBottom=this.options.data.bottom.formatter(this.options.data.bottom.max).toString().length)),this.options.data.left&&this.options.data.left.data&&"undefined"===this.options.data.left.max&&(this.options.data.left.min=d3.min(this.options.data.left.data),this.options.data.left.max=d3.max(this.options.data.left.data)),this.options.data.left&&void 0!==this.options.data.left.max&&(this.longestLeft=this.options.data.left.max.toString().length,this.options.data.left.formatter&&(this.longestLeft=this.options.data.left.formatter(this.options.data.left.max).toString().length)),this.options.data.right&&this.options.data.right.data&&"undefined"===this.options.data.right.max&&(this.options.data.right.min=d3.min(this.options.data.right.data),this.options.data.right.max=d3.max(this.options.data.right.data)),this.options.data.right&&void 0!==this.options.data.right.max&&(this.longestRight=this.options.data.right.max.toString().length,this.options.data.right.formatter&&(this.longestRight=this.options.data.right.formatter(this.options.data.right.max).toString().length)),console.log("longest left",this.longestLeft),console.log("longest right",this.longestRight),this.options.margin.axisLeft=this.longestLeft*(this.options.data.left&&this.options.data.left.fontSize||this.options.fontSize)*.7,this.options.margin.axisRight=this.longestRight*(this.options.data.right&&this.options.data.right.fontSize||this.options.fontSize)*.7,this.options.margin.axisBottom=(this.options.data.bottom&&this.options.data.bottom.fontSize||this.options.fontSize)+10,this.options.data.bottom.rotate&&(this.options.margin.axisBottom=this.longestBottom*(this.options.data.bottom&&this.options.data.bottom.fontSize||this.options.fontSize)*.4),this.options.axis&&(!0===this.options.axis.hideAll&&(this.options.margin.axisLeft=0,this.options.margin.axisRight=0,this.options.margin.axisBottom=0),!0===this.options.axis.hideLeft&&(this.options.margin.axisLeft=0),!0===this.options.axis.hideRight&&(this.options.margin.axisRight=0),!0===this.options.axis.hideBottom&&(this.options.margin.axisBottom=0)),console.log("margins",this.options.margin),this.plotWidth=this.width-this.options.margin.left-this.options.margin.right-this.options.margin.axisLeft-this.options.margin.axisRight,this.plotHeight=this.height-this.options.margin.top-this.options.margin.bottom-this.options.margin.axisBottom,this.leftAxisLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.rightAxisLayer.attr("transform","translate(".concat(this.options.margin.left+this.plotWidth+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.bottomAxisLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top+this.plotHeight,")")),this.plotArea.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.areaLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.lineLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.barLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.symbolLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.trackingLineLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")"));var n=this.options.data.bottom.data.map(function(t){return t.value});this.bottomAxis=d3["scale".concat(this.options.data.bottom.scale||"Band")]().domain(n).padding(0).range([0,this.plotWidth]),0<this.options.margin.axisBottom&&(this.bottomAxisLayer.call(d3.axisBottom(this.bottomAxis)),this.options.data.bottom.rotate&&this.bottomAxisLayer.selectAll("text").attr("transform","rotate(".concat(this.options.data.bottom.rotate,")")).style("text-anchor","end"));var s=[];void 0!==this.options.data.left.min&&void 0!==this.options.data.left.max&&(s=[this.options.data.left.min-.1*this.options.data.left.min,1.1*this.options.data.left.max],!0===this.options.forceZero&&(s=[Math.min(0,this.options.data.left.min),this.options.data.left.max])),this.leftAxis=d3["scale".concat(this.options.data.left.scale||"Linear")]().domain(s).range([this.plotHeight,0]),0<this.options.margin.axisLeft&&this.leftAxisLayer.call(d3.axisLeft(this.leftAxis).tickFormat(function(t){return i.options.data.left.formatter&&(t=i.options.data.left.formatter(t)),t}));var o=[];void 0!==this.options.data.right.min&&void 0!==this.options.data.right.max&&(o=[this.options.data.right.min-.15*this.options.data.right.min,1.15*this.options.data.right.max],!0===this.options.forceZero&&(o=[Math.min(0,this.options.data.right.min-.15*this.options.data.right.min),1.15*this.options.data.right.max])),0<o.length&&(this.rightAxis=d3["scale".concat(this.options.data.right.scale||"Linear")]().domain(o).range([this.plotHeight,0]),0<this.options.margin.axisRight&&this.rightAxisLayer.call(d3.axisRight(this.rightAxis).tickFormat(function(t){return i.options.data.right.formatter&&(t=i.options.data.right.formatter(t)),t}))),this.options.data.series.forEach(function(t,e){t.key||(t.key=i.createIdentity()),t.color||(t.color=i.options.colors[e%i.options.colors.length]),i["render".concat(t.type||"bar")](t,e)})}}else;}},{key:"renderarea",value:function(e,t){var n=this,i=function(e,i,t){return d3.area().x(function(t){return n[e](t.x.value)}).y0(function(t){return n[i](0)}).y1(function(t){return n[i](isNaN(t.y.value)?0:t.y.value)}).curve(d3[t||n.options.curveStyle])},s="bottomAxis",o="secondary"===e.axis?"rightAxis":"leftAxis";"horizontal"===this.options.orienation&&(s="secondary"===e.axis?"rightAxis":"leftAxis",o="bottomAxis");var a=this.areaLayer.selectAll(".area_".concat(e.key)).data([e.data]);a.exit().transition(this.transition).style("fill-opacity",1e-6).remove(),a.transition(this.transition).attr("d",function(t){return i(s,o,e.curveStyle)(t)}),a.enter().append("path").attr("d",function(t){return i(s,o,e.curveStyle)(t)}).attr("class","area_".concat(e.key)).attr("id","area_".concat(e.key)).attr("fill",e.color).style("fill-opacity",0).attr("stroke","transparent").transition(this.transition).style("fill-opacity",e.opacity||1)}},{key:"renderbar",value:function(t,e){}},{key:"renderline",value:function(e,t){var n=this,i=function(e,i,t){return d3.line().x(function(t){return n[e](t.x.value)}).y(function(t){return n[i](isNaN(t.y.value)?0:t.y.value)}).curve(d3[t||n.options.curveStyle])},s="bottomAxis",o="secondary"===e.axis?"rightAxis":"leftAxis";"horizontal"===this.options.orienation&&(s="secondary"===e.axis?"rightAxis":"leftAxis",o="bottomAxis");var a=this.lineLayer.selectAll(".line_".concat(e.key)).data([e.data]);a.exit().transition(this.transition).style("stroke-opacity",1e-6).remove(),a.style("stroke-width",e.lineWidth||this.options.lineWidth).attr("stroke",e.color).attr("fill","transparent").transition(this.transition).attr("d",function(t){return i(s,o,e.curveStyle)(t)}),a.enter().append("path").attr("d",function(t){return i(s,o,e.curveStyle)(t)}).attr("class","line_".concat(e.key)).attr("id","line_".concat(e.key)).style("stroke-width",e.lineWidth||this.options.lineWidth).attr("stroke",e.color).attr("fill","transparent").transition(this.transition).style("stroke-opacity",1),!0===e.showArea&&this.renderarea(e,t),!0===e.showSymbols&&this.rendersymbol(e,t)}},{key:"rendersymbol",value:function(e,t){var i=this,n=function(t){return d3.symbol().size(t||i.options.symbolSize)},s="bottomAxis",o="secondary"===e.axis?"rightAxis":"leftAxis";"horizontal"===this.options.orienation&&(s="secondary"===e.axis?"rightAxis":"leftAxis",o="bottomAxis");var a=this.symbolLayer.selectAll(".symbol_".concat(e.key)).data(e.data);a.exit().transition(this.transition).style("fill-opacity",1e-6).remove(),a.attr("d",function(t){return n(t.y.size||e.symbolSize)(t)}).transition(this.transition).attr("fill","white").attr("stroke",e.color).attr("transform",function(t){return"translate(".concat(i[s](t.x.value),", ").concat(i[o](t.y.value),")")}),a.enter().append("path").attr("d",function(t){return n(t.y.size||e.symbolSize)(t)}).transition(this.transition).attr("fill","white").attr("stroke",e.color).attr("class",function(t){return"symbol symbol_".concat(e.key)}).attr("transform",function(t){return"translate(".concat(i[s](t.x.value),", ").concat(i[o](t.y.value),")")})}},{key:"resize",value:function(){var t=document.getElementById(this.elementId);t&&(this.width=t.clientWidth,this.height=t.clientHeight,this.svg.attr("width",this.width).attr("height",this.height),this.longestRight=5,this.longestBottom=5,this.options.margin.axisLeft=this.longestLeft*(this.options.data.left&&this.options.data.left.fontSize||this.options.fontSize)*.7,this.options.margin.axisRight=this.longestRight*(this.options.data.right&&this.options.data.right.fontSize||this.options.fontSize)*.7,this.options.margin.axisBottom=(this.options.data.bottom&&this.options.data.bottom.fontSize||this.options.fontSize)+10,this.options.data.bottom.rotate&&(this.options.margin.axisBottom=this.longestBottom*(this.options.data.bottom&&this.options.data.bottom.fontSize||this.options.fontSize)*.4),this.options.axis&&(!0===this.options.axis.hideAll&&(this.options.margin.axisLeft=0,this.options.margin.axisRight=0,this.options.margin.axisBottom=0),!0===this.options.axis.hideLeft&&(this.options.margin.axisLeft=0),!0===this.options.axis.hideRight&&(this.options.margin.axisRight=0),!0===this.options.axis.hideBottom&&(this.options.margin.axisBottom=0)),this.plotWidth=this.width-this.options.margin.left-this.options.margin.right-this.options.margin.axisLeft-this.options.margin.axisRight,this.plotHeight=this.height-this.options.margin.top-this.options.margin.bottom-this.options.margin.axisBottom,this.leftAxisLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.rightAxisLayer.attr("transform","translate(".concat(this.options.margin.left+this.plotWidth+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.bottomAxisLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top+this.plotHeight,")")),this.plotArea.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.areaLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.lineLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.barLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.symbolLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")),this.trackingLineLayer.attr("transform","translate(".concat(this.options.margin.left+this.options.margin.axisLeft,", ").concat(this.options.margin.top,")")))}},{key:"data",set:function(t){this.options.data=t,this.render()}}]),s}(),WebsyKPI=function(){function i(t,e){_classCallCheck(this,i);this.elementId=t,this.options=_extends({},{tooltip:{},label:{},value:{},subValue:{}},e)}return _createClass(i,[{key:"render",value:function(t){this.options=_extends({},this.options,t),this.options.label.classes||(this.options.label.classes=[]),this.options.value.classes||(this.options.value.classes=[]),this.options.subValue.classes||(this.options.subValue.classes=[]),this.options.tooltip.classes||(this.options.tooltip.classes=[]),this.resize()}},{key:"resize",value:function(){var t=document.getElementById(this.elementId);if(t){var e='\n        <div class="websy-kpi-container">\n      ';this.options.icon&&(e+='\n          <div class="websy-kpi-icon"><img src="'.concat(this.options.icon,'"></div>   \n        ')),e+='   \n          <div class="websy-kpi-info">\n            <div class="websy-kpi-label '.concat(this.options.label.classes.join(" ")||"",'">\n              ').concat(this.options.label.value||"","\n      "),this.options.tooltip&&this.options.tooltip.value&&(e+='\n          <div class="websy-info '.concat(this.options.tooltip.classes.join(" ")||"",'" data-info="').concat(this.options.tooltip.value,'">\n            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 512 512"><title>ionicons-v5-e</title><path d="M256,56C145.72,56,56,145.72,56,256s89.72,200,200,200,200-89.72,200-200S366.28,56,256,56Zm0,82a26,26,0,1,1-26,26A26,26,0,0,1,256,138Zm48,226H216a16,16,0,0,1,0-32h28V244H228a16,16,0,0,1,0-32h32a16,16,0,0,1,16,16V332h28a16,16,0,0,1,0,32Z"/></svg>\n          </div>   \n        ')),e+='\n            </div>\n            <div class="websy-kpi-value '.concat(this.options.value.classes.join(" ")||"",'">').concat(this.options.value.value,"</div>\n      "),this.options.subValue&&(e+='\n          <div class="websy-kpi-sub-value '.concat(this.options.subValue.classes.join(" ")||"",'">').concat(this.options.subValue.value,"</div>\n        ")),e+="                                \n          </div>\n        </div>\n      ",t.innerHTML=e}}}]),i}(),WebsyDesigns={WebsyPopupDialog:WebsyPopupDialog,WebsyLoadingDialog:WebsyLoadingDialog,WebsyNavigationMenu:WebsyNavigationMenu,WebsyForm:WebsyForm,WebsyDatePicker:WebsyDatePicker,WebsyDropdown:WebsyDropdown,WebsyResultList:WebsyResultList,WebsyPubSub:WebsyPubSub,WebsyTable:WebsyTable,WebsyChart:WebsyChart,WebsyKPI:WebsyKPI,WebsyPDFButton:WebsyPDFButton,PDFButton:WebsyPDFButton,APIService:APIService},GlobalPubSub=new WebsyPubSub("empty",{});function recaptchaReadyCallBack(){GlobalPubSub.publish("recaptchaready")}var rcs=document.createElement("script");rcs.src="//www.google.com/recaptcha/api.js?onload=recaptchaReadyCallBack",document.getElementsByTagName("body")[0].appendChild(rcs);var pps=document.createElement("script");rcs.src="//www.paypal.com/sdk/js",document.getElementsByTagName("body")[0].appendChild(pps);